import{u as p,j as e,H as D,L as A}from"./app-ByqFfibK.js";import{A as T}from"./app-layout-DiNcl9c1.js";import{c as k,B as h}from"./createLucideIcon-1Mp7Gqdz.js";import{I as c}from"./input-BjaqlN3o.js";import{L as i}from"./label-D3AOE3wJ.js";import{T as f}from"./textarea-DGfS8SZF.js";import{C as d,b as o,c as m,a as x}from"./card-BPjGKEHP.js";import{B as u}from"./badge-BQt3yToO.js";import{S as F}from"./separator-Bn6M7CV2.js";import{S as L,a as B,b as R,c as $,d as N}from"./select-WN_IQr-R.js";import{T as g,a as _,b as j,c as l,d as v,e as n}from"./table-CzsQx4c8.js";import{A as I}from"./arrow-left-C1oPCkFn.js";import{D as b}from"./trending-up-DcU5g1xb.js";import{S as E}from"./save-IqazzcZJ.js";import{E as y}from"./external-link-BfEw19dS.js";import{T as H}from"./trash-2-_0LAIcm4.js";/* empty css            */import"./index-CjNSEtXh.js";import"./dropdown-menu-LbdkPehs.js";import"./index-BMFy-bCL.js";import"./index-B4CgvCL3.js";import"./app-logo-icon-B1tWwHL6.js";import"./index-CMWG4mbA.js";import"./log-out-B61pjk2k.js";import"./index-DvDWvjGE.js";import"./check-D1dmdbxb.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],P=k("CirclePlus",U);function he({sponsor:r}){const t=p({type:"top_up",amount:"",reference:"",notes:""}),a=p({recipient_full_name:"",course_id:"",course_external_url:"",amount:"",admin_note:""}),C=s=>{s.preventDefault(),t.post(`/dashboard/sponsors/${r.id}/funds`,{onSuccess:()=>t.reset("amount","reference","notes")})},S=s=>{s.preventDefault(),a.post(`/dashboard/sponsors/${r.id}/allocations`,{onSuccess:()=>a.reset("recipient_full_name","course_id","course_external_url","amount","admin_note")})},w=s=>{confirm("Delete this allocation and refund the amount?")&&a.delete(`/dashboard/sponsors/${r.id}/allocations/${s}`)};return e.jsxs(T,{breadcrumbs:[{title:"Dashboard",href:"/dashboard"},{title:"Sponsors",href:"/dashboard/sponsors"},{title:r.full_name,href:`/dashboard/sponsors/${r.id}`}],children:[e.jsx(D,{title:r.full_name}),e.jsxs("div",{className:"flex flex-col gap-4 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(A,{href:"/dashboard/sponsors",children:e.jsxs(h,{variant:"outline",size:"sm",children:[e.jsx(I,{className:"mr-2 h-4 w-4"})," Back"]})}),e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:r.full_name})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(d,{children:[e.jsx(o,{children:e.jsx(m,{children:"Contact"})}),e.jsxs(x,{className:"space-y-1",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Email:"})," ",r.email]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Phone:"})," ",r.phone||"-"]}),r.admin_note&&e.jsxs(e.Fragment,{children:[e.jsx(F,{}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Admin Note:"}),e.jsx("div",{className:"whitespace-pre-wrap",children:r.admin_note})]})]})]})]}),e.jsxs(d,{children:[e.jsx(o,{children:e.jsx(m,{children:"Amounts"})}),e.jsxs(x,{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Initial Amount"}),e.jsxs(u,{variant:"outline",className:"flex items-center gap-1",children:[e.jsx(b,{className:"h-3 w-3"}),r.formatted_initial_amount??`${Number(r.initial_amount).toFixed(2)} USD`]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Current Balance"}),e.jsxs(u,{className:"flex items-center gap-1",children:[e.jsx(b,{className:"h-3 w-3"}),r.formatted_current_amount??`${Number(r.current_amount).toFixed(2)} USD`]})]})]})]}),e.jsxs(d,{children:[e.jsx(o,{children:e.jsx(m,{children:"Add Funds"})}),e.jsx(x,{children:e.jsxs("form",{className:"grid gap-3",onSubmit:C,children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(i,{children:"Type"}),e.jsxs(L,{value:t.data.type,onValueChange:s=>t.setData("type",s),children:[e.jsx(B,{children:e.jsx(R,{placeholder:"Select type"})}),e.jsxs($,{children:[e.jsx(N,{value:"top_up",children:"Top-up"}),e.jsx(N,{value:"adjustment",children:"Adjustment"})]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(i,{children:"Amount *"}),e.jsx(c,{type:"number",min:"0.01",step:"0.01",value:t.data.amount,onChange:s=>t.setData("amount",s.target.value)}),t.errors.amount&&e.jsx("p",{className:"text-sm text-destructive",children:t.errors.amount})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(i,{children:"Reference"}),e.jsx(c,{value:t.data.reference,onChange:s=>t.setData("reference",s.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(i,{children:"Notes"}),e.jsx(f,{rows:3,value:t.data.notes,onChange:s=>t.setData("notes",s.target.value)})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(h,{type:"submit",disabled:t.processing,children:[e.jsx(E,{className:"mr-2 h-4 w-4"}),t.processing?"Saving...":"Add Funds"]})})]})})]})]}),e.jsxs(d,{children:[e.jsx(o,{children:e.jsx(m,{children:"New Allocation"})}),e.jsx(x,{children:e.jsxs("form",{className:"grid gap-3",onSubmit:S,children:[e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(i,{children:"Recipient Full Name *"}),e.jsx(c,{value:a.data.recipient_full_name,onChange:s=>a.setData("recipient_full_name",s.target.value)}),a.errors.recipient_full_name&&e.jsx("p",{className:"text-sm text-destructive",children:a.errors.recipient_full_name})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(i,{children:"Amount *"}),e.jsx(c,{type:"number",min:"0.01",step:"0.01",value:a.data.amount,onChange:s=>a.setData("amount",s.target.value)}),a.errors.amount&&e.jsx("p",{className:"text-sm text-destructive",children:a.errors.amount})]})]}),e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(i,{children:"Course ID (optional)"}),e.jsx(c,{value:a.data.course_id,onChange:s=>a.setData("course_id",s.target.value),placeholder:"e.g. 123"}),a.errors.course_id&&e.jsx("p",{className:"text-sm text-destructive",children:a.errors.course_id})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(i,{children:"Course External URL (fallback)"}),e.jsx(c,{value:a.data.course_external_url,onChange:s=>a.setData("course_external_url",s.target.value),placeholder:"https://..."}),a.errors.course_external_url&&e.jsx("p",{className:"text-sm text-destructive",children:a.errors.course_external_url})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(i,{children:"Admin Note"}),e.jsx(f,{rows:3,value:a.data.admin_note,onChange:s=>a.setData("admin_note",s.target.value)})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(h,{type:"submit",disabled:a.processing,children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),a.processing?"Saving...":"Create Allocation"]})})]})})]}),e.jsxs(d,{children:[e.jsx(o,{children:e.jsx(m,{children:"Allocations"})}),e.jsxs(x,{className:"p-0",children:[e.jsxs(g,{children:[e.jsx(_,{children:e.jsxs(j,{children:[e.jsx(l,{children:"Recipient"}),e.jsx(l,{children:"Course"}),e.jsx(l,{children:"Amount"}),e.jsx(l,{children:"Created"}),e.jsx(l,{className:"w-12"})]})}),e.jsx(v,{children:r.allocations.map(s=>e.jsxs(j,{children:[e.jsxs(n,{className:"font-medium",children:[e.jsx("div",{children:s.recipient_full_name}),s.admin_note&&e.jsx("div",{className:"text-xs text-muted-foreground line-clamp-2",children:s.admin_note})]}),e.jsx(n,{children:s.course?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(u,{variant:"outline",children:s.course.title}),s.course_external_url&&e.jsxs("a",{className:"text-xs text-blue-600 hover:underline inline-flex items-center gap-1",href:s.course_external_url,target:"_blank",rel:"noreferrer",children:[e.jsx(y,{className:"h-3 w-3"})," external"]})]}):s.course_external_url?e.jsxs("a",{className:"text-xs text-blue-600 hover:underline inline-flex items-center gap-1",href:s.course_external_url,target:"_blank",rel:"noreferrer",children:[e.jsx(y,{className:"h-3 w-3"})," external"]}):e.jsx("span",{className:"text-muted-foreground text-sm",children:"—"})}),e.jsxs(n,{children:[Number(s.amount).toFixed(2)," USD"]}),e.jsx(n,{children:new Date(s.created_at).toLocaleString()}),e.jsx(n,{children:e.jsx(h,{variant:"ghost",size:"sm",className:"text-destructive",onClick:()=>w(s.id),children:e.jsx(H,{className:"h-4 w-4"})})})]},s.id))})]}),r.allocations.length===0&&e.jsx("div",{className:"py-12 text-center text-muted-foreground",children:"No allocations yet."})]})]}),e.jsxs(d,{children:[e.jsx(o,{children:e.jsx(m,{children:"Transactions"})}),e.jsxs(x,{className:"p-0",children:[e.jsxs(g,{children:[e.jsx(_,{children:e.jsxs(j,{children:[e.jsx(l,{children:"Type"}),e.jsx(l,{children:"Amount"}),e.jsx(l,{children:"Reference"}),e.jsx(l,{children:"Notes"}),e.jsx(l,{children:"Created"})]})}),e.jsx(v,{children:r.transactions.map(s=>e.jsxs(j,{children:[e.jsx(n,{children:e.jsx(u,{variant:"outline",children:s.type})}),e.jsxs(n,{children:[Number(s.amount).toFixed(2)," USD"]}),e.jsx(n,{className:"text-sm",children:s.reference||"—"}),e.jsx(n,{className:"text-sm",children:s.notes||"—"}),e.jsx(n,{children:new Date(s.created_at).toLocaleString()})]},s.id))})]}),r.transactions.length===0&&e.jsx("div",{className:"py-12 text-center text-muted-foreground",children:"No transactions yet."})]})]})]})]})}export{he as default};
